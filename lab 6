1.
select avg(waga) from kreatura where rodzaj = 'wiking';
select avg(waga) ,count(rodzaj),rodzaj from kreatura group by rodzaj;
select avg(year(dataUr)) ,count(rodzaj),rodzaj from kreatura group by rodzaj;

2.
select sum(waga),rodzaj from kreatura group by rodzaj;
select nazwa, avg(waga) from zasob group by nazwa having avg(waga)>10 and sum(ilosc) >=4;
select rodzaj, count(nazwa) from zasob group by rodzaj having count(nazwa) > 1;

3.
select nazwa , ilosc from kreatura, ekwipunek where kreatura.idKreatury = ekwipunek.idKreatury;
inner join zasob on zasob.idZasobu=ekwipunek.idZasobu on kreatura.idKreatury=ekwipunek.idKreatury;

4.1
SELECT kreatura.nazwa, zasob.nazwa, dataUr  FROM wikingowie.zasob INNER JOIN wikingowie.kreatura 
INNER JOIN wikingowie.ekwipunek ON wikingowie.ekwipunek.idKreatury=k.idKreatury ON 
wikingowie.ekwipunek.idZasobu=z.idZasobu WHERE dataUr LIKE '167%';
4.2

SELECT dataUr, kreatura.nazwa, zasob.rodzaj FROM wikingowie.kreatura INNER JOIN wikingowie.ekwipunek 
INNER JOIN wikingowie.zasob z ON zasob.idZasobu=ekwipunek.idZasobu ON kreatura.idKreatury=ekwipunek.idKreatury WHERE zasob.rodzaj='jedzenie' 
ORDER BY dataUr ASC LIMIT 5;

#select sum(ekwipunek.ilosc*zasob.ilosc), zasob.nazwa , ekwipunek.idEkwipunku from zasob 
#inner join ekwipunek on ekwipunek.idZasobu = zasob.idZasobu 
#inner join kreatura on kreatura.idKreatury = ekwipunek.idKreatury 
#group by nazwa;

#select kreatura.rodzaj,sum(ekwipunek.ilosc*zasob.waga)/count(distinct(kreatura.nazwa)) as srednia
#from kreatura join ekwipunek on kreatura.idKreatury=ekwipunek.idKreatury
#join zasob on ekwipunek.idZasobu = zasob.idZasobu
#where kreatura.rodzaj not in ('malpa','waz')
#group by kreatura.rodzaj;
